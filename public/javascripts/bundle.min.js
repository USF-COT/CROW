!function e(t,n,i){function o(r,a){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return o(n?n:e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,t){(function(){var e,n;if("undefined"==typeof window)throw new Error("Google-maps package can be used only in browser.");n=function(){throw new Error("Using promises is not supported anymore. Please take a look in new documentation and use callback instead.")},e=function(){function e(){}return e.URL="https://maps.googleapis.com/maps/api/js",e.KEY=null,e.LIBRARIES=[],e.CLIENT=null,e.SENSOR=!1,e._VERSION="3.14",e.VERSION=e._VERSION,e.WINDOW_CALLBACK_NAME="__google_maps_api_provider_initializator__",e.script=null,e.google=null,e.loading=!1,e.callbacks=[],e.onLoadEvents=[],e.load=function(e){return null==e&&(e=null),null===this.google?this.loading===!0?null!==e&&this.callbacks.push(e):(this.loading=!0,window[this.WINDOW_CALLBACK_NAME]=function(t){return function(){return t._ready(e)}}(this),this.script=document.createElement("script"),this.script.type="text/javascript",this.script.src=this.createUrl(),document.body.appendChild(this.script)):null!==e&&e(this.google),{then:function(){return n()},"catch":function(){return n()},fail:function(){return n()}}},e.createUrl=function(){var e;return e=this.URL,e+=this.SENSOR===!0||"true"===this.SENSOR?"?sensor=true":"?sensor=false",null!=this.KEY&&(e+="&key="+this.KEY),this.LIBRARIES.length>0&&(e+="&libraries="+this.LIBRARIES.join(",")),null!=this.CLIENT&&(e+="&client="+this.CLIENT+"&v="+this.VERSION),e+="&callback="+this.WINDOW_CALLBACK_NAME},e.release=function(e){var t;return t=function(t){return function(){return t.KEY=null,t.LIBRARIES=[],t.CLIENT=null,t.SENSOR=!1,t.VERSION=t._VERSION,t.google=null,t.loading=!1,t.callbacks=[],t.onLoadEvents=[],"undefined"!=typeof window.google&&delete window.google,"undefined"!=typeof window[t.WINDOW_CALLBACK_NAME]&&delete window[t.WINDOW_CALLBACK_NAME],null!==t.script&&(t.script.parentElement.removeChild(t.script),t.script=null),e()}}(this),this.loading?this.load(function(){return t()}):t()},e.onLoad=function(e){return this.onLoadEvents.push(e)},e._ready=function(t){var n,i,o,s,r,a,l;for(null==t&&(t=null),e.loading=!1,null===e.google&&(e.google=window.google),a=e.onLoadEvents,i=0,s=a.length;s>i;i++)(n=a[i])(e.google);for(null!==t&&t(e.google),l=e.callbacks,o=0,r=l.length;r>o;o++)(t=l[o])(e.google);return e.callbacks=[]},e}(),"object"==typeof t?t.exports=e:window.GoogleMapsLoader=e}).call(this)},{}],2:[function(e,t){t.exports=e("./src")},{"./src":16}],3:[function(e,t){"use strict";function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){}i.prototype._events=void 0,i.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];if(this._events[e].fn)return[this._events[e].fn];for(var t=0,n=this._events[e].length,i=new Array(n);n>t;t++)i[t]=this._events[e][t].fn;return i},i.prototype.emit=function(e,t,n,i,o,s){if(!this._events||!this._events[e])return!1;var r,a,l=this._events[e],c=arguments.length;if("function"==typeof l.fn){switch(l.once&&this.removeListener(e,l.fn,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,s),!0}for(a=1,r=new Array(c-1);c>a;a++)r[a-1]=arguments[a];l.fn.apply(l.context,r)}else{var u,d=l.length;for(a=0;d>a;a++)switch(l[a].once&&this.removeListener(e,l[a].fn,!0),c){case 1:l[a].fn.call(l[a].context);break;case 2:l[a].fn.call(l[a].context,t);break;case 3:l[a].fn.call(l[a].context,t,n);break;default:if(!r)for(u=1,r=new Array(c-1);c>u;u++)r[u-1]=arguments[u];l[a].fn.apply(l[a].context,r)}}return!0},i.prototype.on=function(e,t,i){var o=new n(t,i||this);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],o]:this._events[e].push(o):this._events[e]=o,this},i.prototype.once=function(e,t,i){var o=new n(t,i||this,!0);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],o]:this._events[e].push(o):this._events[e]=o,this},i.prototype.removeListener=function(e,t,n){if(!this._events||!this._events[e])return this;var i=this._events[e],o=[];if(t&&(i.fn&&(i.fn!==t||n&&!i.once)&&o.push(i),!i.fn))for(var s=0,r=i.length;r>s;s++)(i[s].fn!==t||n&&!i[s].once)&&o.push(i[s]);return o.length?this._events[e]=1===o.length?o[0]:o:delete this._events[e],this},i.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[e]:this._events={},this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.EventEmitter=i,i.EventEmitter2=i,i.EventEmitter3=i,t.exports=i},{}],4:[function(e,t){(function(e){!function(e,n,i){n[e]=n[e]||i(),"undefined"!=typeof t&&t.exports?t.exports=n[e]:"function"==typeof define&&define.amd&&define(function(){return n[e]})}("Promise","undefined"!=typeof e?e:this,function(){"use strict";function e(e,t){f.add(e,t),d||(d=p(f.drain))}function t(e){var t,n=typeof e;return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t?t:!1}function n(){for(var e=0;e<this.chain.length;e++)i(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function i(e,n,i){var o,s;try{n===!1?i.reject(e.msg):(o=n===!0?e.msg:n.call(void 0,e.msg),o===i.promise?i.reject(TypeError("Promise-chain cycle")):(s=t(o))?s.call(o,i.resolve,i.reject):i.resolve(o))}catch(r){i.reject(r)}}function o(i){var r,l,c=this;if(!c.triggered){c.triggered=!0,c.def&&(c=c.def);try{(r=t(i))?(l=new a(c),r.call(i,function(){o.apply(l,arguments)},function(){s.apply(l,arguments)})):(c.msg=i,c.state=1,c.chain.length>0&&e(n,c))}catch(u){s.call(l||new a(c),u)}}}function s(t){var i=this;i.triggered||(i.triggered=!0,i.def&&(i=i.def),i.msg=t,i.state=2,i.chain.length>0&&e(n,i))}function r(e,t,n,i){for(var o=0;o<t.length;o++)!function(o){e.resolve(t[o]).then(function(e){n(o,e)},i)}(o)}function a(e){this.def=e,this.triggered=!1}function l(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var i=new l(this);this.then=function(t,o){var s={success:"function"==typeof t?t:!0,failure:"function"==typeof o?o:!1};return s.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");s.resolve=e,s.reject=t}),i.chain.push(s),0!==i.state&&e(n,i),s.promise},this["catch"]=function(e){return this.then(void 0,e)};try{t.call(void 0,function(e){o.call(i,e)},function(e){s.call(i,e)})}catch(r){s.call(i,r)}}var u,d,f,h=Object.prototype.toString,p="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),u=function(e,t,n,i){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:i!==!1})}}catch(m){u=function(e,t,n){return e[t]=n,e}}f=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,n,i;return{add:function(o,s){i=new e(o,s),n?n.next=i:t=i,n=i,i=void 0},drain:function(){var e=t;for(t=n=d=void 0;e;)e.fn.call(e.self),e=e.next}}}();var g=u({},"constructor",c,!1);return u(c,"prototype",g,!1),u(g,"__NPO__",0,!1),u(c,"resolve",function(e){var t=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new t(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");t(e)})}),u(c,"reject",function(e){return new this(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");n(e)})}),u(c,"all",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");var o=e.length,s=Array(o),a=0;r(t,e,function(e,t){s[e]=t,++a===o&&n(s)},i)})}),u(c,"race",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");r(t,e,function(e,t){n(t)},i)})}),c})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t){t.exports={}},{}],6:[function(e,t,n){n.createdStores=[],n.createdActions=[],n.reset=function(){for(;n.createdStores.length;)n.createdStores.pop();for(;n.createdActions.length;)n.createdActions.pop()}},{}],7:[function(e,t){var n=e("./utils"),i=e("./joins").instanceJoinCreator,o=function(e){for(var t,n=0,i={};n<(e.children||[]).length;++n)t=e.children[n],e[t]&&(i[t]=e[t]);return i},s=function(e){var t={};for(var i in e){var r=e[i],a=o(r),l=s(a);t[i]=r;for(var c in l){var u=l[c];t[i+n.capitalize(c)]=u}}return t};t.exports={hasListener:function(e){for(var t,n,i,o=0;o<(this.subscriptions||[]).length;++o)for(i=[].concat(this.subscriptions[o].listenable),t=0;t<i.length;t++)if(n=i[t],n===e||n.hasListener&&n.hasListener(e))return!0;return!1},listenToMany:function(e){var t=s(e);for(var i in t){var o=n.callbackName(i),r=this[o]?o:this[i]?i:void 0;r&&this.listenTo(t[i],r,this[o+"Default"]||this[r+"Default"]||r)}},validateListening:function(e){return e===this?"Listener is not able to listen to itself":n.isFunction(e.listen)?e.hasListener&&e.hasListener(this)?"Listener cannot listen to this listenable because of circular loop":void 0:e+" is missing a listen method"},listenTo:function(e,t,i){var o,s,r,a=this.subscriptions=this.subscriptions||[];return n.throwIf(this.validateListening(e)),this.fetchInitialState(e,i),o=e.listen(this[t]||t,this),s=function(){var e=a.indexOf(r);n.throwIf(-1===e,"Tried to remove listen already gone from subscriptions list!"),a.splice(e,1),o()},r={stop:s,listenable:e},a.push(r),r},stopListeningTo:function(e){for(var t,i=0,o=this.subscriptions||[];i<o.length;i++)if(t=o[i],t.listenable===e)return t.stop(),n.throwIf(-1!==o.indexOf(t),"Failed to remove listen from subscriptions list!"),!0;return!1},stopListeningToAll:function(){for(var e,t=this.subscriptions||[];e=t.length;)t[0].stop(),n.throwIf(t.length!==e-1,"Failed to remove listen from subscriptions list!")},fetchInitialState:function(e,t){t=t&&this[t]||t;var i=this;if(n.isFunction(t)&&n.isFunction(e.getInitialState)){var o=e.getInitialState();o&&n.isFunction(o.then)?o.then(function(){t.apply(i,arguments)}):t.call(this,o)}},joinTrailing:i("last"),joinLeading:i("first"),joinConcat:i("all"),joinStrict:i("strict")}},{"./joins":17,"./utils":21}],8:[function(e,t){var n=e("./utils"),i=e("./ListenerMethods");t.exports=n.extend({componentWillUnmount:i.stopListeningToAll},i)},{"./ListenerMethods":7,"./utils":21}],9:[function(e,t){var n=e("./utils");t.exports={preEmit:function(){},shouldEmit:function(){return!0},listen:function(e,t){t=t||this;var n=function(n){e.apply(t,n)},i=this;return this.emitter.addListener(this.eventLabel,n),function(){i.emitter.removeListener(i.eventLabel,n)}},promise:function(e){var t=this,n=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0;if(!n)throw new Error('Publisher must have "completed" and "failed" child publishers');e.then(function(e){return t.completed(e)}),e["catch"](function(e){return t.failed(e)})},listenAndPromise:function(e,t){var n=this;return t=t||this,this.listen(function(){if(!e)throw new Error("Expected a function returning a promise but got "+e);var i=arguments,o=e.apply(t,i);return n.promise.call(n,o)},t)},trigger:function(){var e=arguments,t=this.preEmit.apply(this,e);e=void 0===t?e:n.isArguments(t)?t:[].concat(t),this.shouldEmit.apply(this,e)&&this.emitter.emit(this.eventLabel,e)},triggerAsync:function(){var e=arguments,t=this;n.nextTick(function(){t.trigger.apply(t,e)})},triggerPromise:function(){var e=this,t=arguments,i=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0;if(!i)throw new Error('Publisher must have "completed" and "failed" child publishers');var o=n.createPromise(function(n,i){var o=e.completed.listen(function(e){o(),s(),n(e)}),s=e.failed.listen(function(e){o(),s(),i(e)});e.triggerAsync.apply(e,t)});return o}}},{"./utils":21}],10:[function(e,t){t.exports={}},{}],11:[function(e,t){t.exports=function(e,t){for(var n in t){var i=t[n];"function"==typeof i&&t.hasOwnProperty(n)&&(e[n]=i.bind(e))}return e}},{}],12:[function(e,t){var n=e("./index"),i=e("./utils");t.exports=function(e,t){return{getInitialState:function(){return i.isFunction(e.getInitialState)?void 0===t?e.getInitialState():i.object([t],[e.getInitialState()]):{}},componentDidMount:function(){i.extend(this,n.ListenerMethods);var o=this,s=void 0===t?this.setState:function(e){o.setState(i.object([t],[e]))};this.listenTo(e,s)},componentWillUnmount:n.ListenerMixin.componentWillUnmount}}},{"./index":16,"./utils":21}],13:[function(e,t){var n=e("./index"),i=e("./utils");t.exports=function(e,t,o){return o=i.isFunction(t)?t:o,{getInitialState:function(){if(i.isFunction(e.getInitialState)){if(i.isFunction(t))return o.call(this,e.getInitialState());var n=o.call(this,e.getInitialState());return n?i.object([t],[n]):{}}return{}},componentDidMount:function(){i.extend(this,n.ListenerMethods);var s=this,r=function(e){if(i.isFunction(t))s.setState(o.call(s,e));else{var n=o.call(s,e);s.setState(i.object([t],[n]))}};this.listenTo(e,r)},componentWillUnmount:n.ListenerMixin.componentWillUnmount}}},{"./index":16,"./utils":21}],14:[function(e,t){var n=e("./utils"),i=e("./index"),o=e("./Keep"),s={preEmit:1,shouldEmit:1},r=function(e){e=e||{},n.isObject(e)||(e={actionName:e});for(var t in i.ActionMethods)if(!s[t]&&i.PublisherMethods[t])throw new Error("Cannot override API method "+t+" in Reflux.ActionMethods. Use another method name or override it on Reflux.PublisherMethods instead.");for(var a in e)if(!s[a]&&i.PublisherMethods[a])throw new Error("Cannot override API method "+a+" in action creation. Use another method name or override it on Reflux.PublisherMethods instead.");e.children=e.children||[],e.asyncResult&&(e.children=e.children.concat(["completed","failed"]));for(var l=0,c={};l<e.children.length;l++){var u=e.children[l];c[u]=r(u)}var d=n.extend({eventLabel:"action",emitter:new n.EventEmitter,_isAction:!0},i.PublisherMethods,i.ActionMethods,e),f=function(){f[f.sync?"trigger":"triggerAsync"].apply(f,arguments)};return n.extend(f,c,d),o.createdActions.push(f),f};t.exports=r},{"./Keep":6,"./index":16,"./utils":21}],15:[function(e,t){var n=e("./utils"),i=e("./index"),o=e("./Keep"),s=e("./mixer"),r={preEmit:1,shouldEmit:1},a=e("./bindMethods");t.exports=function(e){function t(){var t,i=0;if(this.subscriptions=[],this.emitter=new n.EventEmitter,this.eventLabel="change",a(this,e),this.init&&n.isFunction(this.init)&&this.init(),this.listenables)for(t=[].concat(this.listenables);i<t.length;i++)this.listenToMany(t[i])}e=e||{};for(var l in i.StoreMethods)if(!r[l]&&(i.PublisherMethods[l]||i.ListenerMethods[l]))throw new Error("Cannot override API method "+l+" in Reflux.StoreMethods. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");for(var c in e)if(!r[c]&&(i.PublisherMethods[c]||i.ListenerMethods[c]))throw new Error("Cannot override API method "+c+" in store creation. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");e=s(e),n.extend(t.prototype,i.ListenerMethods,i.PublisherMethods,i.StoreMethods,e);var u=new t;return o.createdStores.push(u),u}},{"./Keep":6,"./bindMethods":11,"./index":16,"./mixer":20,"./utils":21}],16:[function(e,t,n){n.ActionMethods=e("./ActionMethods"),n.ListenerMethods=e("./ListenerMethods"),n.PublisherMethods=e("./PublisherMethods"),n.StoreMethods=e("./StoreMethods"),n.createAction=e("./createAction"),n.createStore=e("./createStore"),n.connect=e("./connect"),n.connectFilter=e("./connectFilter"),n.ListenerMixin=e("./ListenerMixin"),n.listenTo=e("./listenTo"),n.listenToMany=e("./listenToMany");var i=e("./joins").staticJoinCreator;n.joinTrailing=n.all=i("last"),n.joinLeading=i("first"),n.joinStrict=i("strict"),n.joinConcat=i("all");var o=e("./utils");n.createActions=function(e){var t={};for(var i in e){var s=e[i],r=o.isObject(s)?i:s;t[r]=n.createAction(s)}return t},n.setEventEmitter=function(t){var n=e("./utils");n.EventEmitter=t},n.setPromise=function(t){var n=e("./utils");n.Promise=t},n.setPromiseFactory=function(t){var n=e("./utils");n.createPromise=t},n.nextTick=function(t){var n=e("./utils");n.nextTick=t},n.__keep=e("./Keep"),Function.prototype.bind||console.error("Function.prototype.bind not available. ES5 shim required. https://github.com/spoike/refluxjs#es5")},{"./ActionMethods":5,"./Keep":6,"./ListenerMethods":7,"./ListenerMixin":8,"./PublisherMethods":9,"./StoreMethods":10,"./connect":12,"./connectFilter":13,"./createAction":14,"./createStore":15,"./joins":17,"./listenTo":18,"./listenToMany":19,"./utils":21}],17:[function(e,t,n){function i(e,t,n){return function(){var i,o=n.subscriptions,s=o?o.indexOf(e):-1;for(l.throwIf(-1===s,"Tried to remove join already gone from subscriptions list!"),i=0;i<t.length;i++)t[i]();o.splice(s,1)}}function o(e){e.listenablesEmitted=new Array(e.numberOfListenables),e.args=new Array(e.numberOfListenables)}function s(e,t){return function(){var n=a.call(arguments);if(t.listenablesEmitted[e])switch(t.strategy){case"strict":throw new Error("Strict join failed because listener triggered twice.");case"last":t.args[e]=n;break;case"all":t.args[e].push(n)}else t.listenablesEmitted[e]=!0,t.args[e]="all"===t.strategy?[n]:n;r(t)}}function r(e){for(var t=0;t<e.numberOfListenables;t++)if(!e.listenablesEmitted[t])return;e.callback.apply(e.listener,e.args),o(e)}var a=Array.prototype.slice,l=e("./utils"),c=e("./createStore"),u={strict:"joinStrict",first:"joinLeading",last:"joinTrailing",all:"joinConcat"};n.staticJoinCreator=function(e){return function(){var t=a.call(arguments);return c({init:function(){this[u[e]].apply(this,t.concat("triggerAsync"))}})}},n.instanceJoinCreator=function(e){return function(){l.throwIf(arguments.length<3,"Cannot create a join with less than 2 listenables!");var t,n,r=a.call(arguments),c=r.pop(),u=r.length,d={numberOfListenables:u,callback:this[c]||c,listener:this,strategy:e},f=[];for(t=0;u>t;t++)l.throwIf(this.validateListening(r[t]));for(t=0;u>t;t++)f.push(r[t].listen(s(t,d),this));return o(d),n={listenable:r},n.stop=i(n,f,this),this.subscriptions=(this.subscriptions||[]).concat(n),n}}},{"./createStore":15,"./utils":21}],18:[function(e,t){var n=e("./index");t.exports=function(e,t,i){return{componentDidMount:function(){for(var o in n.ListenerMethods)if(this[o]!==n.ListenerMethods[o]){if(this[o])throw"Can't have other property '"+o+"' when using Reflux.listenTo!";this[o]=n.ListenerMethods[o]}this.listenTo(e,t,i)},componentWillUnmount:n.ListenerMethods.stopListeningToAll}}},{"./index":16}],19:[function(e,t){var n=e("./index");t.exports=function(e){return{componentDidMount:function(){for(var t in n.ListenerMethods)if(this[t]!==n.ListenerMethods[t]){if(this[t])throw"Can't have other property '"+t+"' when using Reflux.listenToMany!";this[t]=n.ListenerMethods[t]}this.listenToMany(e)},componentWillUnmount:n.ListenerMethods.stopListeningToAll}}},{"./index":16}],20:[function(e,t){var n=e("./utils");t.exports=function(e){var t={init:[],preEmit:[],shouldEmit:[]},i=function o(e){var i={};return e.mixins&&e.mixins.forEach(function(e){n.extend(i,o(e))}),n.extend(i,e),Object.keys(t).forEach(function(n){e.hasOwnProperty(n)&&t[n].push(e[n])}),i}(e);return t.init.length>1&&(i.init=function(){var e=arguments;t.init.forEach(function(t){t.apply(this,e)},this)}),t.preEmit.length>1&&(i.preEmit=function(){return t.preEmit.reduce(function(e,t){var n=t.apply(this,e);return void 0===n?e:[n]}.bind(this),arguments)}),t.shouldEmit.length>1&&(i.shouldEmit=function(){var e=arguments;return!t.shouldEmit.some(function(t){return!t.apply(this,e)},this)}),Object.keys(t).forEach(function(e){1===t[e].length&&(i[e]=t[e][0])}),i}},{"./utils":21}],21:[function(e,t,n){var i=n.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e};n.extend=function(e){if(!i(e))return e;for(var t,n,o=1,s=arguments.length;s>o;o++){t=arguments[o];for(n in t)e[n]=t[n]}return e},n.isFunction=function(e){return"function"==typeof e},n.EventEmitter=e("eventemitter3"),n.nextTick=function(e){setTimeout(e,0)},n.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n.callbackName=function(e){return"on"+n.capitalize(e)},n.object=function(e,t){for(var n={},i=0;i<e.length;i++)n[e[i]]=t[i];return n},n.Promise=e("native-promise-only"),n.createPromise=function(e){return new n.Promise(e)},n.isArguments=function(e){return"object"==typeof e&&"callee"in e&&"number"==typeof e.length},n.throwIf=function(e,t){if(e)throw Error(t||e)}},{eventemitter3:3,"native-promise-only":4}],22:[function(e,t){var n=e("reflux"),i=n.createActions({mapLoaded:{},loadFeeds:{children:["completed","failed"]},loadSource:{children:["completed","failed"]},showLayer:{},hideLayer:{},layerSelected:{},layerUnselected:{},timeRangeChanged:{},addDataset:{},loadDataset:{children:["completed","failed"]},removeDataset:{}});i.loadFeeds.preEmit=function(){$.ajax({dataType:"json",url:"/feeds",success:i.loadFeeds.completed,failure:i.loadFeeds.failed})},i.loadSource.preEmit=function(e){$.ajax({dataType:"jsonp",url:e+"/layers",success:i.loadSource.completed,failure:i.loadSource.failed})},t.exports=i},{reflux:2}],23:[function(e){(function(t){var n="undefined"!=typeof window?window.React:"undefined"!=typeof t?t.React:null,i="undefined"!=typeof window?window.ReactRouter:"undefined"!=typeof t?t.ReactRouter:null,o=(i.Route,e("./components/CROWApp.jsx"));n.render(n.createElement(o,null),document.getElementById("crowapp"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/CROWApp.jsx":24}],24:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("./MapManager.jsx"),s=e("../actions.jsx"),r="undefined"!=typeof window?window.ReactRouter:"undefined"!=typeof n?n.ReactRouter:null,a=(r.RouteHandler,i.createClass({displayName:"CROWApp",componentWillMount:function(){s.loadFeeds()},render:function(){return i.createElement(o,null)}}));t.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"./MapManager.jsx":27}],25:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=(e("reflux"),e("../actions.jsx")),s=i.createClass({displayName:"EditPlotsRow",exportClicked:function(e){var t="data:text/csv;charset=utf-8,";t+="Unix Timestamp,Timestamp,"+this.props.dataset.field_uri+"\r\n",this.props.dataset.data.forEach(function(e){t+=e[0]+",",t+=moment(1e3*e[0]).format()+",",t+=e[1]+"\r\n"},this),e.currentTarget.href=encodeURI(t)},removeClicked:function(e){e.preventDefault(),o.removeDataset(this.props.dataset)},render:function(){var e={backgroundColor:this.props.dataset.color},t=this.props.dataset.source_url+"-"+this.props.dataset.layer_uri+"-"+this.props.dataset.field_uri+".csv";return i.createElement("tr",null,i.createElement("td",{style:e}),i.createElement("td",null,this.props.dataset.layer_uri),i.createElement("td",null,this.props.dataset.field.name),i.createElement("td",null,i.createElement("button",{className:"btn btn-danger",onClick:this.removeClicked},i.createElement("i",{className:"fa fa-minus"})," Remove")),i.createElement("td",null,i.createElement("a",{download:t,target:"_blank",className:"btn btn-info",onClick:this.exportClicked},i.createElement("i",{className:"fa fa-download"})," Export as CSV")))}}),r=i.createClass({displayName:"EditPlotsModal",removeClicked:function(e){o.removeDataset(e)},render:function(){var e=[];return this.props.datasetsStore&&(e=this.props.datasetsStore.datasets.map(function(e,t){return i.createElement(s,{key:t,dataset:e})})),i.createElement("span",{className:"editPlotsModalDiv"},i.createElement("button",{type:"button",className:"btn btn-info btn-block","data-toggle":"modal","data-target":"#editPlotsModal"},i.createElement("i",{className:"fa fa-pencil-square-o"})," Edit Plots"),i.createElement("div",{className:"modal fade",id:"editPlotsModal",tabIndex:"-1",role:"dialog","aria-labelledby":"editPlotsModalLabel","aria-hidden":"true"},i.createElement("div",{className:"modal-dialog"},i.createElement("div",{className:"modal-content"},i.createElement("div",{className:"modal-header"},i.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.createElement("span",{"aria-hidden":"true"},"Ã—")),i.createElement("h4",{className:"modal-title",id:"editPlotsModalLabel"},"Edit Plots")),i.createElement("div",{className:"modal-body"},i.createElement("table",{className:"table"},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"Color"),i.createElement("th",null,"Layer"),i.createElement("th",null,"Field"),i.createElement("th",null),i.createElement("th",null))),i.createElement("tbody",null,e))),i.createElement("div",{className:"modal-footer"},i.createElement("button",{type:"button",className:"btn btn-info","data-dismiss":"modal","aria-label":"Close"},"Close"))))))}});t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,reflux:2}],26:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("./MapPanelMixin.jsx"),s=i.createClass({displayName:"LogoPanel",mixins:[o],render:function(){return i.createElement("div",{id:"logo-region"},i.createElement("img",{id:"logo",src:"/images/CROWLogo150.png",alt:"CROW Logo"}))}});t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MapPanelMixin.jsx":28}],27:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("google-maps"),s=e("./LogoPanel.jsx"),r=e("./NavBar.jsx"),a=e("./PlotPanel.jsx"),l=e("../actions.jsx"),c=e("../stores/SourcesStore.jsx"),u=e("../stores/KMLLayerStore.jsx"),d=e("reflux"),f=("undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,i.createClass({displayName:"MapManager",mixins:[d.connect(c,"sources"),d.connect(u,"visibleSourceKML")],componentDidMount:function(){o.KEY="AIzaSyCM0VMLhaVUkmn9jKpSrh1mIZB2G8RJw9E",o.load(function(e){var t={center:new e.maps.LatLng(27.760603,-84.632873),zoom:7,mapTypeId:e.maps.MapTypeId.HYBRID,mapTypeControl:!0,mapTypeControlOptions:{style:e.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:e.maps.ControlPosition.TOP_RIGHT},panControl:!0,panControlOptions:{position:e.maps.ControlPosition.RIGHT},zoomControl:!0,zoomControlOptions:{style:e.maps.ZoomControlStyle.LARGE,position:e.maps.ControlPosition.RIGHT},scaleControl:!0,scaleControlOptions:{position:e.maps.ControlPosition.RIGHT},streetViewControl:!1},n=new e.maps.Map(document.getElementById("map-canvas"),t);l.mapLoaded(e,n)})},render:function(){return i.createElement("div",{id:"map"},i.createElement("div",{id:"map-canvas"}),i.createElement(s,{position:"TOP_LEFT"}),i.createElement(r,{position:"TOP_CENTER",sources:this.state.sources}),i.createElement(a,{position:"BOTTOM_CENTER"}))}}));t.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"../stores/KMLLayerStore.jsx":35,"../stores/SourcesStore.jsx":38,"./LogoPanel.jsx":26,"./NavBar.jsx":29,"./PlotPanel.jsx":31,"google-maps":1,reflux:2}],28:[function(e,t){var n=(e("google-maps"),e("../stores/MapStore.jsx")),i=e("reflux"),o={mixins:[i.ListenerMixin],onMapLoaded:function(e,t){var n=e.maps.ControlPosition[this.props.position],i=this.getDOMNode();i.index=this.props.pos_index,t.controls[n].push(i)},componentDidMount:function(){this.listenTo(n,this.onMapLoaded)}};t.exports=o},{"../stores/MapStore.jsx":36,"google-maps":1,reflux:2}],29:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("./MapPanelMixin.jsx"),s=e("../actions.jsx"),r=e("./TimeRangeForm.jsx"),a="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.createClass({displayName:"LayerItem",getInitialState:function(){return{checked:!1}},onChange:function(e){e.target.checked?s.showLayer(this.props.source.url,this.props.layer.uri):s.hideLayer(this.props.source.url,this.props.layer.uri)},componentDidMount:function(){s.showLayer.listen(function(e,t){e==this.props.source.url&&t==this.props.layer.uri&&this.setState({checked:!0})},this),s.hideLayer.listen(function(e,t){e==this.props.source.url&&t==this.props.layer.uri&&this.setState({checked:!1})},this)},render:function(){return i.createElement("li",{onClick:this.onClick},i.createElement("div",{className:"checkbox"},i.createElement("label",null,i.createElement("input",{type:"checkbox",onChange:this.onChange,checked:this.state.checked})," ",this.props.layer.name)))}}),c=i.createClass({displayName:"NavBarDropDown",render:function(){var e=a.groupBy(this.props.source.layers,function(e){return e.station_type}),t=[];return a.each(e,function(e,n){var o=a.sortBy(e,"name"),s=o.map(function(e){return i.createElement(l,{key:e.uri,source:this.props.source,layer:e})},this);t.push(i.createElement("div",{key:this.props.source.provider.short_name+"."+n},i.createElement("label",{className:"layer-group-header"},n),i.createElement("ul",{className:"layer-group-ul"},s)))},this),i.createElement("li",{className:"dropdown"},i.createElement("a",{href:"#",className:"dropdown-toggle","data-toggle":"dropdown",role:"button","aria-expanded":"false"},this.props.source.provider.short_name,i.createElement("span",{className:"caret"})),i.createElement("ul",{className:"dropdown-menu layers-ul",role:"menu"},t))}}),u=i.createClass({displayName:"NavBar",mixins:[o],render:function(){var e=[];return this.props.sources&&a.each(this.props.sources,function(t){e.push(i.createElement(c,{key:t.provider.url,source:t}))}),i.createElement("div",{id:"nav-region"},i.createElement("div",{id:"nav-container",className:"control-box"},i.createElement("nav",{className:"navbar navbar-default"},i.createElement("div",{className:"container-fluid"},i.createElement("div",{className:"navbar-header"},i.createElement("button",{type:"button",className:"navbar-toggle collapsed","data-toggle":"collapse","data-target":"#navbar-collapse"},i.createElement("span",{className:"sr-only"},"Toggle navigation"),i.createElement("span",{className:"icon-bar"}),i.createElement("span",{className:"icon-bar"}),i.createElement("span",{className:"icon-bar"})),i.createElement("a",{className:"navbar-brand",href:"#"},"Layers")),i.createElement("div",{className:"collapse navbar-collapse",id:"navbar-collapse"},i.createElement("ul",{className:"nav navbar-nav"},e),i.createElement(r,{formClass:"navbar-form navbar-right"}))))))}});t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"./MapPanelMixin.jsx":28,"./TimeRangeForm.jsx":33}],30:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("reflux"),s=e("../actions.jsx"),r=e("../stores/VisibleSourcesStore.jsx"),a=e("../stores/SelectedLayerStore.jsx"),l=e("./EditPlotsModal.jsx"),c="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,u="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,d=i.createClass({displayName:"PlotForm",mixins:[o.listenTo(a,"onLayerSelect")],onPlotFormSubmit:function(e){e.preventDefault(),s.addDataset(this.state.selected_source_url,this.state.selected_layer_uri,this.state.selected_field_uri)
},getInitialState:function(){return{selected_source_url:"empty",selected_layer_uri:"empty",selected_field_uri:"empty",sources:{}}},onLayerSelect:function(e,t){this.setState({selected_source_url:e,selected_layer_uri:t})},onFormSourceSelect:function(e){this.setState({selected_source_url:e.target.value,selected_layer_uri:"empty"})},onFormLayerSelect:function(e){this.setState({selected_layer_uri:e.target.value})},onFormFieldSelect:function(e){this.setState({selected_field_uri:e.target.value})},componentDidMount:function(){u("#startDateTimePicker").datetimepicker(),u("#endDateTimePicker").datetimepicker()},render:function(){var e=i.createElement("option",{key:"empty",value:void 0}),t=[];t.push(e);var n=c.sortBy(this.props.visibleSources,function(e){return e.provider.short_name});c.each(n,function(e){t.push(i.createElement("option",{key:e.url,value:e.url},e.provider.short_name))},this);var o=[];if(o.push(e),layers=r.getLayers(this.state.selected_source_url),layers){var s=c.sortBy(layers,"name");c.each(s,function(e){o.push(i.createElement("option",{key:e.uri,value:e.uri},e.name))},this)}var a=[];a.push(e);var u=r.getLayer(this.state.selected_source_url,this.state.selected_layer_uri);if(u){var d=c.sortBy(u.fields,"name");c.each(d,function(e){a.push(i.createElement("option",{key:e.uri,value:e.uri},e.name))},this)}return i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-10"},i.createElement("form",{id:"plotForm",className:"form-inline",onSubmit:this.onPlotFormSubmit},i.createElement("div",{className:"form-group"},i.createElement("h4",{id:"plot-panel-title"},"Plot Data")),i.createElement("div",{className:"form-group"},i.createElement("label",{className:"sr-only"},"Data Source"),i.createElement("select",{name:"source_url",className:"form-control plot-select",value:this.state.selected_source_url,onChange:this.onFormSourceSelect},t)),i.createElement("div",{className:"form-group"},i.createElement("label",{className:"sr-only"},"Layer"),i.createElement("select",{name:"layer_uri",className:"form-control plot-select",value:this.state.selected_layer_uri,onChange:this.onFormLayerSelect},o)),i.createElement("div",{className:"form-group"},i.createElement("label",{className:"sr-only"},"Field"),i.createElement("select",{name:"field_uri",className:"form-control plot-select",value:this.state.selected_field_uri,onChange:this.onFormFieldSelect},a)),i.createElement("button",{className:"btn btn-primary",type:"submit",form:"plotForm"},i.createElement("i",{className:"fa fa-line-chart"})," Plot"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"pull-right"},i.createElement(l,{datasetsStore:this.props.datasetsStore}))))}});t.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"../stores/SelectedLayerStore.jsx":37,"../stores/VisibleSourcesStore.jsx":41,"./EditPlotsModal.jsx":25,reflux:2}],31:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("reflux"),s=e("./MapPanelMixin.jsx"),r=e("./PlotForm.jsx"),a=e("./PlotSVG.jsx"),l=e("../stores/VisibleSourcesStore.jsx"),c=e("../stores/DatasetsStore.jsx"),u=i.createClass({displayName:"PlotPanel",mixins:[s,o.connect(l,"visibleSources"),o.connect(c,"datasetsStore")],render:function(){return i.createElement("div",{id:"plot-region"},i.createElement("div",{id:"plot-container",className:"control-box"},i.createElement("div",{className:"plot-panel panel"},i.createElement("div",{className:"panel-heading"},i.createElement(r,{visibleSources:this.state.visibleSources,datasetsStore:this.state.datasetsStore})),i.createElement("div",{className:"container-fluid"},i.createElement(a,{datasetsStore:this.state.datasetsStore})))))}});t.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../stores/DatasetsStore.jsx":34,"../stores/VisibleSourcesStore.jsx":41,"./MapPanelMixin.jsx":28,"./PlotForm.jsx":30,"./PlotSVG.jsx":32,reflux:2}],32:[function(e,t){(function(e){var n="undefined"!=typeof window?window.React:"undefined"!=typeof e?e.React:null,i="undefined"!=typeof window?window.d3:"undefined"!=typeof e?e.d3:null,o="undefined"!=typeof window?window._:"undefined"!=typeof e?e._:null,s=n.createClass({displayName:"PlotSVG",margins:{top:0,right:10,bottom:20,left:10},shouldComponentUpdate:function(){return!1},setupAxis:function(){this.timeScale=i.time.scale.utc().domain([this.props.datasetsStore.range.start.toDate(),this.props.datasetsStore.range.end.toDate()]).range([this.margins.left,this.dim.width+this.margins.left]),this.timeScale.ticks(i.time.hour,12);var e=i.svg.axis().scale(this.timeScale).orient("bottom");this.svg.append("g").attr("id","timeAxis").attr("class","timeX axis").attr("transform","translate(0,"+(this.dim.height+this.margins.top)+")").call(e),this.yScale=i.scale.linear().range([this.margins.top+this.dim.height,this.margins.top]),this.touchYScale=i.scale.linear().domain([0,1]).range([this.margins.top+this.dim.height,this.margins.top])},onTouch:function(){this.updateBars(i.touches(this.svg.node()))},onMouse:function(){this.updateBars([i.mouse(this.svg.node())])},updateBars:function(e){var t=this.svg.selectAll(".touch-bar-group").data(e,function(e){return e.identifier}),n=t.enter().append("g").attr("class","touch-bar-group");n.append("line");var s=n.append("g").attr("class","legend");s.append("rect").attr("class","legend-background"),s.append("text").attr("class","time-value");var r=this.dim,a=this.timeScale,l=(this.yScale,this.touchYScale),c=t.select("line").attr("x1",function(e){return e[0]}).attr("x2",function(e){return e[0]}).attr("y1",function(){return l(0)}).attr("y2",function(){return l(1)}),u=t.select(".legend").attr("render-order",1).attr("transform",function(e){var t=e[0],n=5,i=this.getBBox().width,o=t+n;return o+i>r.width&&(o=t-2*n-i),"translate("+o+", 0)"});u.select(".time-value").text(function(e){var t=a.invert(e[0]);return t.toISOString()}).attr("x",0).attr("y",function(){return this.getBBox().height}).attr("dx",5).attr("dy",2);var d=u.selectAll(".dataset-value").data(this.props.datasetsStore.datasets);d.enter().append("g").attr("class","dataset-value").append("text"),d.select("text").attr("stroke",function(e){return e.color}).attr("fill",function(e){return e.color}).text(function(e){var t=a.invert(parseFloat(c.attr("x1"))).getTime()/1e3,n=e.data,s=(i.extent(n,function(e){return e[1]}),o.find(n,function(e){return e[0]>t}));if(s){var r=e.station_uri+" "+e.field.name+" "+s[1].toFixed(2);return e.field.units&&(r+=" "+e.field.units),r}return"NO DATA"}).attr("x",0).attr("y",function(e,t){return(t+2)*this.getBBox().height}).attr("dx",5).attr("dy",2);u.select(".legend-background").attr("x",0).attr("y",0).attr("height",function(){return this.parentNode.getBBox().height}).attr("width",function(){return this.parentNode.getBBox().width}),d.exit().remove(),t.exit().remove()},componentWillReceiveProps:function(e){var t=e.datasetsStore.range,n=e.datasetsStore.datasets;this.timeScale.domain([t.start.toDate(),t.end.toDate()]);var o=i.svg.axis().scale(this.timeScale).orient("bottom");this.svg.select("#timeAxis").transition().duration(1e3).ease("sin-in-out").call(o);var s=this.timeScale,r=this.yScale,a=this.svg.selectAll(".dataset").data(n);a.enter().insert("g",".touch-bar-group").attr("class","dataset").append("path").attr("class","line"),a.select("path").attr("stroke",function(e){return e.color}).attr("d",function(e){r.domain([0,1]);var t=i.svg.line().interpolate("linear").x(function(e){return s(new Date(1e3*e[0]))}).y(function(){return r(0)});return t(e.data)}).transition().duration(1e3).ease("sin-in-out").attr("d",function(e){var t=i.extent(e.data,function(e){return e[1]});r.domain(t);var n=i.svg.line().interpolate("linear").x(function(e){return s(new Date(1e3*e[0]))}).y(function(e){return r(e[1])});return n(e.data)}),a.exit().remove()},componentDidMount:function(){this.svg=i.select("#plots-area"),this.dim={height:parseInt(this.svg.style("height"))-(this.margins.top+this.margins.bottom),width:parseInt(this.svg.style("width"))-(this.margins.left+this.margins.right)},this.setupAxis(),this.svg.on("touchmove",this.onTouch).on("mousemove",this.onMouse)},render:function(){return n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-12"},n.createElement("svg",{id:"plots-area"})))}});t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t){(function(n){var i="undefined"!=typeof window?window.React:"undefined"!=typeof n?n.React:null,o=e("reflux"),s=e("../actions.jsx"),r=e("../stores/TimeRangeStore.jsx"),a="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,l=("undefined"!=typeof window?window.moment:"undefined"!=typeof n?n.moment:null,i.createClass({displayName:"TimeRangeForm",mixins:[o.connect(r,"range")],shouldComponentUpdate:function(){return!1},componentWillReceiveProps:function(){a("#startDatePicker").data("DateTimePicker").date(this.state.range.start),a("#endDatePicker").data("DateTimePicker").date(this.state.range.end)},componentDidMount:function(){a("#startDatePicker").datetimepicker(),a("#endDatePicker").datetimepicker();var e=this.state.range;a("#startDatePicker").on("dp.change",null,e,function(e){a("#endDatePicker").data("DateTimePicker").minDate(e.date),s.timeRangeChanged(e.date,e.data.end)}),a("#endDatePicker").on("dp.change",null,e,function(e){a("#startDatePicker").data("DateTimePicker").maxDate(e.date),s.timeRangeChanged(e.data.start,e.date)}),a("#startDatePicker").data("DateTimePicker").date(e.start),a("#endDatePicker").data("DateTimePicker").date(e.end)},render:function(){return i.createElement("form",{className:this.props.formClass},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"startDate"},"From:"),i.createElement("input",{id:"startDatePicker",name:"startDate",type:"text",className:"form-control"})),i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"endDate"},"to"),i.createElement("input",{id:"endDatePicker",name:"endDate",type:"text",className:"form-control"})))}}));t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"../stores/TimeRangeStore.jsx":40,reflux:2}],34:[function(e,t){(function(n){var i=e("reflux"),o=e("../actions.jsx"),s=e("./TimeRangeStore.jsx"),r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,a="undefined"!=typeof window?window.d3:"undefined"!=typeof n?n.d3:null,l=i.createStore({init:function(){this.state=this.getInitialState(),this.listenTo(o.addDataset,this.onAddDataset),this.listenTo(o.removeDataset,this.onRemoveDataset),this.listenTo(o.loadDataset,this.onDatasetLoadRequest),this.listenTo(o.loadDataset.completed,this.onDatasetLoaded),this.listenTo(o.loadDataset.failed,this.onDatasetLoadFailed),this.listenTo(s,this.onTimeRangeChange)},getInitialState:function(){return{range:s.getInitialState(),datasets:[],colors:a.scale.category10()}},_retrieveDataset:function(e,t,n,i){var o="//"+e+"/datasets";return r.ajax({dataType:"jsonp",data:{layer_uri:t,field_uri:n,start:i.start.unix(),end:i.end.unix()},url:o})},onDatasetLoadRequest:function(e,t,n){var i=this._retrieveDataset(e,t,n,this.state.range);i.then(function(i){o.loadDataset.completed(i,e,t,n)}),i.fail(o.loadDataset.failed)},onAddDataset:function(e,t,n){-1==this.findDatasetIndex(e,t,n)?o.loadDataset(e,t,n):console.log("Dataset already loaded")},setColors:function(){this.state.datasets.forEach(function(e,t){e.color=this.state.colors(t%10)},this)},onRemoveDataset:function(e){var t=this.findDatasetIndex(e.source_url,e.layer_uri,e.field_uri);t>=0?(this.state.datasets.splice(t,1),this.setColors(),this.trigger(this.state)):console.log("Bad index passed to remove datasets action: "+t)},findDatasetIndex:function(e,t,n){return _.findIndex(this.state.datasets,{source_url:e,layer_uri:t,field_uri:n})},addDataset:function(e,t,n,i){e.source_url=t,e.layer_uri=n,e.field_uri=i;var o=this.findDatasetIndex(t,n,i);-1!=o?(e.color=this.state.colors(o%10),this.state.datasets[o]=e):(e.color=this.state.colors(this.state.datasets.length%10),this.state.datasets.push(e))},onDatasetLoaded:function(e,t,n,i){this.addDataset(e,t,n,i),this.trigger(this.state)},onDatasetLoadFailed:function(e){console.log("Error loading plot data: "+e)},onTimeRangeChange:function(e){this.state.range=e;var t=[];this.state.datasets.forEach(function(n){var i=this._retrieveDataset(n.source_url,n.layer_uri,n.field_uri,e),s=this;i.then(function(e){s.addDataset(e,n.source_url,n.layer_uri,n.field_uri)}),i.fail(o.loadDataset.failed),t.push(i)},this);var n=this;r.when.apply(r,t).done(function(){n.trigger(n.state)})}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"./TimeRangeStore.jsx":40,reflux:2}],35:[function(e,t){(function(n){var i=e("reflux"),o=e("./MapStore.jsx"),s=e("./VisibleSourcesStore.jsx"),r=e("./TimeRangeStore.jsx"),a=e("../actions.jsx"),l="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,c=i.createStore({init:function(){this.visibleSourceKML={},this.listenTo(a.mapLoaded,this.onMapLoaded)},onMapLoaded:function(){this.onVisibleSourcesChange(s.sources),this.listenTo(s,this.onVisibleSourcesChange),this.listenTo(r,this.onTimeRangeChange)},_genURL:function(e,t){var n="http://"+e+"/kml?layer_uri="+t;return n+="&start="+r.range.start.unix(),n+="&end="+r.range.end.unix()},onVisibleSourcesChange:function(e){l.each(e,function(e,t){t in this.visibleSourceKML||(this.visibleSourceKML[t]={});var n=l.keys(this.visibleSourceKML[t]),i=l.keys(e.layers),s=l.difference(i,n);s.forEach(function(e){var n=this._genURL(t,e),i=new o.google.maps.KmlLayer({url:n,preserveViewport:!0});i.setMap(o.map),o.google.maps.event.addListener(i,"click",function(){a.layerSelected(t,e)}),this.visibleSourceKML[t][e]=i},this);var r=l.difference(n,i);r.forEach(function(e){this.visibleSourceKML[t][e].setMap(null),o.google.maps.event.clearInstanceListeners(this.visibleSourceKML[t][e]),delete this.visibleSourceKML[t][e]},this)},this)},onTimeRangeChange:function(){l.each(this.visibleSourceKML,function(e,t){l.each(this.visibleSourceKML[t],function(e,n){var i=this._genURL(t,n);this.visibleSourceKML[t][n].setUrl(i)},this)},this)}});t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"./MapStore.jsx":36,"./TimeRangeStore.jsx":40,"./VisibleSourcesStore.jsx":41,reflux:2}],36:[function(e,t){var n=e("reflux"),i=e("../actions.jsx"),o=n.createStore({init:function(){this.listenTo(i.mapLoaded,this.onMapLoaded)},onMapLoaded:function(e,t){this.google=e,this.map=t,this.trigger(e,t)}});t.exports=o},{"../actions.jsx":22,reflux:2}],37:[function(e,t){var n=e("reflux"),i=e("../actions.jsx"),o=n.createStore({init:function(){this.listenTo(i.layerSelected,this.onLayerSelected)},onLayerSelected:function(e,t){this.source_url=e,this.layer_uri=t,this.trigger(this.source_url,this.layer_uri)}});t.exports=o},{"../actions.jsx":22,reflux:2}],38:[function(e,t){(function(n){var i=e("reflux"),o=e("../actions.jsx"),s=e("./SourcesStoreMixin.jsx"),r="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,a=i.createStore({mixins:[s],init:function(){this.sources={},this.listenTo(o.loadFeeds.completed,this.onLoadFeeds),this.listenTo(o.loadSource.completed,this.onLoadSource)},onLoadFeeds:function(e){e.forEach(function(e){o.loadSource(e.url)})},onLoadSource:function(e){this.sources[e.url]=e,r.forEach(e.layers,function(t,n){o.showLayer(e.url,n)},this),this.trigger(this.sources)}});t.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"./SourcesStoreMixin.jsx":39,reflux:2}],39:[function(e,t){var n={sourceExists:function(e){return e in this.sources},getSource:function(e){return this.sourceExists(e)?this.sources[e]:void 0},layerExists:function(e,t){return e in this.sources&&t in this.sources[e].layers?!0:!1},getLayers:function(e){return e in this.sources?this.sources[e].layers:void 0},getLayer:function(e,t){return this.layerExists(e,t)?this.sources[e].layers[t]:void 0},setLayer:function(e,t,n){var i=this.getLayers(e);i[t]=n}};t.exports=n},{}],40:[function(e,t){(function(n){var i=e("reflux"),o=e("../actions.jsx"),s="undefined"!=typeof window?window.moment:"undefined"!=typeof n?n.moment:null,r=i.createStore({init:function(){this.range=this.getInitialState(),this.listenTo(o.timeRangeChanged,this.onTimeRangeChanged)},getInitialState:function(){return{start:s().subtract(5,"days"),end:s()}},onTimeRangeChanged:function(e,t){this.range.start=e,this.range.end=t,this.trigger(this.range)}});t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,reflux:2}],41:[function(e,t){(function(n){var i=e("reflux"),o=e("../actions.jsx"),s=e("./SourcesStore.jsx"),r=e("./SourcesStoreMixin.jsx"),a="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,l=i.createStore({mixins:[r],init:function(){this.sources={},this.listenTo(o.showLayer,this.onShowLayer),this.listenTo(o.hideLayer,this.onHideLayer)},onShowLayer:function(e,t){if(!(e in this.sources)){var n=s.getSource(e);this.sources[e]=a.omit(n,"layers"),this.sources[e].layers={}}var i=s.getLayer(e,t);this.setLayer(e,t,i),this.trigger(this.sources)},onHideLayer:function(e,t){this.layerExists(e,t)&&(delete this.sources[e].layers[t],0===a.size(this.sources[e].layers)&&delete this.sources[e],this.trigger(this.sources))}});t.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../actions.jsx":22,"./SourcesStore.jsx":38,"./SourcesStoreMixin.jsx":39,reflux:2}]},{},[23]);